import type { ChangeEvent } from "react";
import * as Form from "@radix-ui/react-form";
import Link from "next/link";

export const VulnerabilitySearch = () => {
  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {
    console.log(e.target.value);
  };
  const handleHoverSuggestion = (e: ChangeEvent<HTMLInputElement>) => {
    console.log(e.target.value);
  };

  return (
    <div className="flex w-full grow flex-col items-center justify-center ">
      <SearchInput onChange={handleChange} />
      <CveSuggestions />
    </div>
  );
};

interface SearchInputProps {
  onChange: (e: ChangeEvent<HTMLInputElement>) => void;
}

const SearchInput: React.FC<SearchInputProps> = ({ onChange }) => {
  return (
    <Form.Root className="w-full">
      <Form.Field className="relative w-full" name="search">
        <Form.Control
          className="flex h-14 w-full grow items-center justify-center rounded-lg border border-violet-800 bg-transparent pl-12 text-xl text-white/80 transition-colors duration-200 ease-in-out focus:border-violet-500 focus:outline-none"
          type="text"
          placeholder="CVE Lookup"
          onChange={onChange}
        />
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          strokeWidth={1.5}
          stroke="currentColor"
          className="absolute left-3 top-1/2 h-6 w-6 -translate-y-1/2 transform text-white/80"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"
          />
        </svg>
      </Form.Field>
    </Form.Root>
  );
};

const cveData = [
  {
    data_type: "CVE",
    id: "CVE-2021-3156",
    details:
      'Sudo before 1.9.5p2 contains an off-by-one error that can result in a heap-based buffer overflow, which allows privilege escalation to root via "sudoedit -s" and a command-line argument that ends with a single backslash character.',
  },
  {
    data_type: "CVE",
    id: "CVE-2017-0143",
    details:
      'The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka "Windows SMB Remote Code Execution Vulnerability." This vulnerability is different from those described in CVE-2017-0144, CVE-2017-0145, CVE-2017-0146, and CVE-2017-0148.',
  },
];

//Boxes for the cve suggestions
export const CveSuggestions = ({}) => {
  return (
    <div className="mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 md:gap-8">
      {cveData.map((cve) => (
        <Link
          className="w-[200px]flex max-w-xs flex-col gap-4 overflow-hidden overflow-ellipsis rounded-xl bg-white/10 p-4 text-white hover:bg-white/20"
          href={`/report?cve=${cve.id}`}
          key={cve.id}
        >
          <h3 className="text-2xl font-bold">{cve.id}</h3>
          <div className="text-lg">
            {cve.details.length > 100
              ? `${cve.details.substring(0, 90)}...`
              : cve.details}
          </div>
        </Link>
      ))}
    </div>
  );
};

const CveIcon = () => {
  return (
    <svg
      version="1.1"
      id="Layer_1"
      viewBox="0 0 1366 768"
      xmlns="http://www.w3.org/2000/svg"
      className="flex w-40 fill-current text-violet-100"
    >
      <path
        id="pikzDk.tif"
        d="M1354.17,374c0.47,3.31-0.79,5.81-3.34,7.95c-2.42,2.03-3.73,5.01-5.55,7.52
        c-5.24,7.27-11.75,13.58-16.57,21.08c-3.48,5.41-7.66,6.71-13.67,6.69c-51.64-0.21-103.29-0.12-154.93-0.26
        c-3.65-0.01-5.02,2.24-6.65,4.54c-10.59,15.01-21.08,30.11-31.74,45.07c-12.55,17.61-25.48,34.95-37.79,52.73
        c-7.51,10.84-14.89,21.78-23.17,32.04c-5.22,6.47-11.76,12.57-19.7,14.5c-13.82,3.36-27.5,2.56-38.91-8.14
        c-8.48-7.95-14-18.05-20.78-27.23c-9.01-12.19-17.33-24.87-26.09-37.24c-8.18-11.54-16.19-23.24-24.27-34.87
        c-8.78-12.62-17.49-25.28-26.15-37.98c-1.49-2.19-2.96-3.38-5.92-3.36c-33.13,0.14-66.29-0.62-99.39,0.35
        c-21.71,0.64-39.33,10.84-49.82,30.37c-5.15,9.59-6.85,20.27-4.3,31.65c2.56,11.39,7.28,21.07,16.29,28.38
        c7.8,6.33,16.93,10.18,26.56,12.94c7.17,2.06,14.5,2.51,21.88,2.51c40.32,0.02,80.64-0.04,120.96-0.02c1.43,0,3.33-0.66,4.19,0.94
        c1,1.87-0.93,2.83-1.89,4.07c-8.73,11.22-17.49,22.43-26.1,33.74c-1.18,1.55-2.38,1.92-4.14,1.92c-35.9-0.03-71.81,0.26-107.7-0.27
        c-6.59-0.1-13.5-0.76-20.11-3.32c-4.42-1.71-9.61-1.73-14.19-3.49c-14.92-5.74-29.02-13.06-40.62-24.23
        c-10.09-9.72-17.58-21.34-22.81-34.45c-3.07-7.71-3.79-15.88-5.73-23.8c0-4.7,0-9.4,0-14.09c1.81-4.68,2-9.77,3-14.6
        c1.33-6.44,4.05-12.16,6.81-17.78c5.72-11.62,14.47-21.05,24.57-29.05c10.93-8.66,23.49-14.66,36.7-18.58
        c7.92-2.35,16.15-4.68,24.69-4.61c2.11,0.02,4.28-0.42,6.16-1.6c42.54,0,85.08,0,127.63,0c0.53,0.6,1.39,1.14,1.53,1.82
        c1.07,5.14,1.3,10.47,0.51,15.55c-0.53,3.39,0.5,3.41,2.94,3.38c4-0.05,8.01-0.06,12.01,0.11c2.68,0.11,3.79-0.98,3.75-3.62
        c-0.07-4.28,0.21-8.58-0.08-12.84c-0.16-2.32,0.81-3.45,2.55-4.4c5.8,0,11.6,0,17.4,0c1.16,1.05,1.76,2.22,1.71,3.93
        c-0.15,4.97-0.18,9.94-0.02,14.91c0.09,2.74-0.94,3.68-3.6,3.6c-4.69-0.14-9.39,0.07-14.07-0.09c-2.31-0.08-3.22,0.63-3.13,3.01
        c0.14,3.86,0.3,7.75-0.03,11.59c-0.3,3.44,1.21,4.34,4.21,4.3c4.55-0.06,9.09-0.01,13.64,0.05c2.69,0.03,4.77,0.78,6.46,3.37
        c6.99,10.66,14.3,21.1,21.45,31.66c5.75,8.49,11.48,17,17.13,25.56c4,6.06,8.35,11.88,12.01,18.18c2.7,4.65,5.98,8.96,9.1,13.35
        c1.31,1.84,3.04,2.67,4.62,0.3c7.14-10.67,14.68-21.05,22.26-31.41c7.77-10.62,14.95-21.68,22.51-32.46
        c8.61-12.28,17.2-24.58,26.08-36.66c8.06-10.96,14.93-22.77,23.77-33.17C1202.23,374,1278.2,374,1354.17,374z M912.7,396.38
        c-2.21,0-4.42,0.1-6.62-0.03c-1.81-0.1-2.81,0.24-2.82,2.39c-0.01,2.61-0.62,5.22-0.55,7.82c0.08,2.86-0.01,6.06,1.29,8.38
        c0.51,0.91,4.55-0.15,6.98-0.28c0.96-0.05,1.93-0.01,2.9-0.03c8.75-0.12,8.56,2.01,8.53-8.67
        C922.38,396.41,922.4,396.41,912.7,396.38z M1168.89,450.22c-3.53-0.02-4.62,0.7-4.6,4.49c0.17,34.96,0.18,69.91-0.01,104.87
        c-0.02,3.98,1.4,4.36,4.7,4.36c50.83-0.09,101.65-0.09,152.48,0.01c2.82,0.01,4.58-0.9,6.22-3.08c7.97-10.61,16-21.17,24.16-31.63
        c1.28-1.63,3.34-2.98,2.14-5.15c-0.98-1.77-3.26-0.8-4.94-0.81c-29.42-0.04-58.84-0.02-88.26-0.02c-13.54,0-27.07-0.09-40.61,0.05
        c-2.55,0.03-3.62-0.87-4.29-3.17c-0.68-2.3,0.95-4.28,0.53-6.46c-1.41-7.26-0.58-14.6-0.53-21.89c0.04-5.86,0.45-5.86,6.17-5.86
        c30.11,0,60.22-0.08,90.33,0.09c4.11,0.02,7.18-1.58,9.1-4.57c6.05-9.42,13.85-17.48,20.16-26.68c0.76-1.11,3.2-1.5,2.11-3.49
        c-1-1.82-3-0.97-4.56-0.97c-28.31-0.04-56.63-0.03-84.94-0.03C1225.8,450.3,1197.35,450.36,1168.89,450.22z M1003.74,376.52
        c-2.23-3.14-5.9-1.46-8.9-1.56c-11.87-0.39-11.18-1.46-11.11,10.91c0.06,11.01-1.4,10.19,10.25,10.13
        c9.38-0.05,11.2,2.18,10.08-11.07C1003.58,382.45,1005.64,379.19,1003.74,376.52z"
      />
    </svg>
  );
};
